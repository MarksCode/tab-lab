<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" ng-app="myApp" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en" ng-app="myApp" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en" ng-app="myApp" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" ng-app="plaeChefApp" class="customizer" xmlns="http://www.w3.org/1999/html"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Plae Chef app</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/plae-chef.css">
    <link rel="stylesheet" href="css/waves.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="app/bower_components/angular-material/angular-material.min.css">



</head>
<body ng-controller="PlaeChefController as plaeChef">

      <div ng-view class="view-frame plae-chef-window">

      <div class="shop-menu">
          <div class="logo"><img src="img/logo.png"></div>
      </div>

              <div class="styles-menu-container" id="tabs">

                  <div class='colorways' id="tabs_container">
                      <div id="colors-ty">
                          <ul class="colorways-list">
                              <li ng-repeat="shoe in shoeList | filter: {name:'ty'}" ng-model="shoeSelected" class="colorway" ng-show="true">
                                  <a href ng-click="plaeChef.setShoe(shoe)"><img ng-src="{{ shoe.menuImgUrl }}"/></a>
                              </li>
                          </ul>
                      </div>
                  </div> <!--End tabs container-->

                  <div class="tabs-menu left effect6">
                  <ul class="tab-styles-list">
                      <li class='tab-list' ng-repeat="tab in tabList" ng-model="tabs" class='tabs-menu' id="left-{{tab.id}}">
                          <a href ng-click="plaeChef.addTab(tab, 'left', $event)"><img ng-src="{{ tab.menuImg }}"/></a>
                      </li>

                  </ul>
              </div>


                  <div class="tabs-menu right effect6">
                      <ul class="tab-styles-list">
                          <li class='tab-list' ng-repeat="tab in tabList" ng-model="tabs" class='tabs-menu' id="right-{{tab.id}}">
                              <a href ng-click="plaeChef.addTab(tab, 'right', $event)"><img ng-src="{{ tab.menuImg }}"/></a>
                          </li>

                      </ul>
                  </div>
              </div> <!--End tabs-->

      <div class="plae size" id="plae-size">

          <!-- Sizer integration -->

          <div id="shoesizer_desc_content">

              <a href="shoesizer://start" onclick="startLiveDemo();" style="text-decoration: none; color: #fff;"><div id="startShoeSizerButton" style="text-align:center; width: 320px; padding:10px; cursor: pointer; cursor: hand; background:rgb(69, 127, 64);  border-radius: 5px; box-shadow: 0px 3px 0px rgb(50, 93, 47);" class="button btn-cart"><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">get a perfect fit with fit-n-PLAE</p></div></a>

              <div id="shoesizer_desc_measurements_and_fit" style="display:none; margin-bottom: 10px;"><div style="width:100%; float: left;"><p style="font-family: 'CenturyGothicStd'; font-size:12pt; line-height: 12pt; margin-bottom: 10px; color: #999;">your measurements</p><div style="padding:20px; background:rgb(69, 127, 64); display: inline-block;  border-radius: 5px;"><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">Size: <span id="shoesizer_desc_measurements_size" style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff; font-weight: bold">US 10</span><br>Tab size: <span id="shoesizer_desc_measurements_tab" style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff; font-weight: bold">L</span><br><br></p><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">Length: <span id="shoesizer_desc_measurements_length"  style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">11.5</span>"<br>Width: <span id="shoesizer_desc_measurements_width" style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">8.4</span>"<br>Girth: <span id="shoesizer_desc_measurements_girth" style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">9.1</span>"</p></div><br><br><div style="text-align:center; padding:10px; cursor: pointer; cursor: hand; background:rgb(69, 127, 64);  border-radius: 5px; box-shadow: 0px 3px 0px rgb(50, 93, 47);" onclick="toggleStartShoeSizerButton()" class="button btn-cart"><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">measure again</p></div></div><div style="width:50%; float: left;"><!--p style="font-family: 'CenturyGothicStd'; font-size: 24pt; line-height: 24pt; margin-top: 40px; margin-bottom: 10px; color: #000;">Your fit</p><img src="http://volumental-django-static.s3.amazonaws.com/img/shoesizer/result.jpg"--></div></div>

              <div id="shoesizer_desc_no_measurements" style="display:none;"><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #000;">No measurements recorded, please install the "fit-n-PLAE"-application.<br><br></p></div>

              <div id="startingShoeSizerButton" style="text-align:center; width: 300px; padding:10px 20px; cursor: pointer; cursor: hand; background:#a0a0a0; display:none; border-radius: 5px; "><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">trying to start app...</p></div>

              <div id="waitingShoeSizerButton" style="text-align:center; width: 300px; padding:10px 20px; cursor: pointer; cursor: hand; background:#a0a0a0; display:none; border-radius: 5px; "><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">waiting for data from app...</p></div>

              <a href="installLink" style="text-decoration: none; color: #fff;"><div id="installShoeSizerButton" style="text-align:center; width: 300px; padding:10px 20px; cursor: pointer; cursor: hand; background:#808080; display:none; border-radius: 5px; box-shadow: 0px 3px 0px #606060;"><p style="font-size: 12pt; line-height: 12pt; font-family: 'CenturyGothicStd'; color: #fff;">install fit-n-PLAE and get a perfect fit</p></div></a>

              <div id="results" style="display:none;"></div>
              <div id="connection" style="display:none;">Waiting for Socket...</div>

              <script type="text/javascript">
                  function update_result_html(content) {
                      document.getElementById("results").innerHTML += content + "<br>";
                      return document.getElementById("results").innerHTML;
                  }
                  function update_connection_html(content) {
                      document.getElementById("connection").innerHTML = content;
                      return document.getElementById("connection").innerHTML;
                  }
                  function cm_to_formatted_inches(cm) {
                      var inches = cm/2.54;
                      if (inches-Math.round(inches)==0) {
                          return inches.toString();
                      } else {
                          return inches.toFixed(1);
                      }
                  }
                  function girth_cm_to_tab_size(girth_cm) {
                      /*
                       Small =  < 188mm
                       Medium =  188mm - 204mm
                       Large = 204mm - 230mm
                       X-Large = > 230mm
                       */
                      if (isNaN(girth_cm)) {
                          return "No matching tab";
                      } else {
                          if (girth_cm<18.8) { return "Small" }
                          if (18.8<=girth_cm && girth_cm<20.4) { return "Medium" }
                          if (20.4<=girth_cm && girth_cm<23.0) { return "Large" }
                          if (girth_cm>=23.0) { return "X-Large" }
                      }
                      return "No matching tab";
                  }
                  function visualizeFeetData(data) {
                      // Toggle visibility for measurement elements
                      document.getElementById("shoesizer_desc_measurements_and_fit").style.display = "block";
                      document.getElementById("shoesizer_desc_no_measurements").style.display ="none";
                      document.getElementById("shoesizer_desc_measurements_size").innerHTML = data.goplae_size + " ("+data.goplae_size_category+")";
                      document.getElementById("shoesizer_desc_measurements_tab").innerHTML = girth_cm_to_tab_size(data.girth);
                      document.getElementById("shoesizer_desc_measurements_length").innerHTML = cm_to_formatted_inches(data.length);
                      document.getElementById("shoesizer_desc_measurements_width").innerHTML = cm_to_formatted_inches(data.width);
                      document.getElementById("shoesizer_desc_measurements_girth").innerHTML = cm_to_formatted_inches(data.girth);
                      hideAllShoeSizerButtons();
                      return true;
                  }
                  function toggleInstallShoeSizerButton() {
                      document.getElementById("shoesizer_desc_measurements_and_fit").style.display = "none";
                      document.getElementById("shoesizer_desc_no_measurements").style.display ="block";
                      document.getElementById("startShoeSizerButton").style.display = "none";
                      document.getElementById("installShoeSizerButton").style.display ="block";
                      document.getElementById("startingShoeSizerButton").style.display ="none";
                      document.getElementById("waitingShoeSizerButton").style.display = "none";
                      return true;
                  }
                  function toggleStartingShoeSizerButton() {
                      document.getElementById("startShoeSizerButton").style.display = "none";
                      document.getElementById("installShoeSizerButton").style.display ="none";
                      document.getElementById("waitingShoeSizerButton").style.display ="none";
                      document.getElementById("startingShoeSizerButton").style.display ="block";
                      return true;
                  }
                  function toggleWaitingShoeSizerButton() {
                      document.getElementById("startShoeSizerButton").style.display = "none";
                      document.getElementById("installShoeSizerButton").style.display = "none";
                      document.getElementById("waitingShoeSizerButton").style.display = "block";
                      document.getElementById("startingShoeSizerButton").style.display = "none";
                      return true;
                  }
                  function toggleStartShoeSizerButton() {
                      document.getElementById("shoesizer_desc_measurements_and_fit").style.display = "none";
                      document.getElementById("shoesizer_desc_no_measurements").style.display ="block";
                      document.getElementById("startShoeSizerButton").style.display = "block";
                      document.getElementById("installShoeSizerButton").style.display ="none";
                      document.getElementById("waitingShoeSizerButton").style.display = "none";
                      document.getElementById("startingShoeSizerButton").style.display = "none";
                      return true;
                  }
                  function hideAllShoeSizerButtons() {
                      document.getElementById("startShoeSizerButton").style.display = "none";
                      document.getElementById("installShoeSizerButton").style.display ="none";
                      document.getElementById("waitingShoeSizerButton").style.display = "none";
                      document.getElementById("startingShoeSizerButton").style.display = "none";
                      return true;
                  }
                  function toggleDebug() {
                      if (document.getElementById("results").style.display == "none") {
                          document.getElementById("results").style.display = "block";
                          document.getElementById("connection").style.display ="block";
                      } else {
                          document.getElementById("results").style.display = "none";
                          document.getElementById("connection").style.display ="none";
                      }
                      return true;
                  }
                  function startSocket() {
                      var obj = new WebSocket("ws://localhost:8888/shoesizer");
                      return obj;
                  }

                  // Create ShoeSizerIntegration class and start function
                  function ShoeSizerIntegration(socket) {
                      this.socket = socket;
                      this.succesfulSocket = false;
                  }

                  ShoeSizerIntegration.prototype.start = function() {
                      this.succesfulSocket = false;
                      update_result_html("Opening...");

                      var _this = this;

                      _this.socket.onopen = function(event) {
                          update_connection_html("Connection OK.");
                          update_result_html("Connected! Sending ShoeSizerWebHandshake...");
                          _this.socket.send(JSON.stringify({response:"ShoeSizerWebHandshake"}));
                          _this.succesfulSocket = true;
                      };

                      _this.socket.onerror = function(event) {
                          update_result_html("Error<br>");
                      };

                      _this.socket.onmessage = function(event) {
                          update_result_html("Received '" + event.data);
                          var obj = JSON.parse(event.data);
                          if ("response" in obj) {
                              if (obj["response"] == "ShoeSizerAppHandshake") {
                                  update_result_html("Received ShoeSizerAppHandshake...");
                                  toggleWaitingShoeSizerButton();
                              }
                              if (obj["response"] == "ShoeSizerAppData") {
                                  update_result_html("Received ShoeSizerAppData...");
                                  _this.socket.send(JSON.stringify({response:"ShoeSizerWebDataReceived"}));
                                  update_result_html("Sending ShoeSizerWebDataReceived...");
                                  visualizeFeetData(obj);
                              }
                          }
                      };

                      _this.socket.onclose = function(event) {
                          update_result_html("Closed!<br>");
                          if(!_this.succesfulSocket) {
                              toggleInstallShoeSizerButton();
                              update_connection_html("Failed to connect. Please install app.");
                          }
                      }
                  }

                  var ssi;
                  function startLiveDemo() {
                      toggleStartingShoeSizerButton();
                      setTimeout(function(){
                          ssi = new ShoeSizerIntegration(startSocket());
                          ssi.start();
                      }, 5000);

                  }
              </script>
          </div>

          <!-- end Sizer integration -->

      </div>

                <div class="canvas container">
              <!--  <canvas class='canvas' id="plae-chef-canvas" ng-swipe-right="plaeChef.setCanvas('right')" ng-swipe-left="plaeChef.setCanvas('left')" ng-show="plaeChef.isCanvasSet('default')"></canvas>
              <canvas class='canvas' id="plae-chef-canvas-pair" ng-swipe-right="plaeChef.setCanvas('right')" ng-swipe-left="plaeChef.setCanvas('left')" ng-show="plaeChef.isCanvasSet('pair')"></canvas>
              <canvas class='canvas tcanvas' id="plae-chef-canvas-tab-pair" ng-swipe-right="plaeChef.setCanvas('right')" ng-swipe-left="plaeChef.setCanvas('left')" ng-show="plaeChef.isCanvasSet('pair')"></canvas>
              -->
                    <canvas class='canvas' id="plae-chef-canvas-left" ng-swipe-right="plaeChef.setCanvas('right')" ng-swipe-left="plaeChef.setCanvas('top')" ng-show="plaeChef.isCanvasSet('left')"></canvas>
              <canvas class='canvas tcanvas' id="plae-chef-canvas-tab-left" ng-swipe-right="plaeChef.setCanvas('right')" ng-swipe-left="plaeChef.setCanvas('top')" ng-show="plaeChef.isCanvasSet('left')"></canvas>

                    <canvas class='canvas' id="plae-chef-canvas-top" ng-swipe-right="plaeChef.setCanvas('left')" ng-swipe-left="plaeChef.setCanvas('right')" ng-show="plaeChef.isCanvasSet('top')"></canvas>
                    <canvas class='canvas tcanvas' id="plae-chef-canvas-tab-top" ng-swipe-right="plaeChef.setCanvas('left')" ng-swipe-left="plaeChef.setCanvas('right')" ng-show="plaeChef.isCanvasSet('top')"></canvas>


                    <canvas class='canvas' id="plae-chef-canvas-right" ng-swipe-right="plaeChef.setCanvas('top')" ng-swipe-left="plaeChef.setCanvas('left')" ng-show="plaeChef.isCanvasSet('right')"></canvas>
                    <canvas class='canvas tcanvas' id="plae-chef-canvas-tab-right" ng-swipe-right="plaeChef.setCanvas('top')" ng-swipe-left="plaeChef.setCanvas('left')" ng-show="plaeChef.isCanvasSet('right')"></canvas>


              <div id="white-bg"></div>

              <div class="views">
              <!--    <button class="waves-effect waves-button waves-light waves-float" id="default-button" ng-click="plaeChef.setCanvas('default')" style="background: #0d39ff;color: #fff;">
                      Left & Right
                  </button> -->

                  <md-button class="view-button md-raised" id="left-profile-button" ng-click="plaeChef.setCanvas('left')" style="background: #01BCFF;color: #fff;">
                      Left
                  </md-button>
                  <md-button class="view-button md-raised" id="top-button" ng-click="plaeChef.setCanvas('top')" style="background: #1bb556;color: #fff;">
                      Top
                  </md-button>
                  <md-button class="view-button md-raised" id="right-profile-button" ng-click="plaeChef.setCanvas('right')" style="background: #ff6f03;color: #fff;">
                      Right
                  </md-button>

              </div>
      </div>
          <div class="plae basket" id="plae-basket">

              <md-button id="edit" ng-click="plaeChef.setEditMode()"><img src="img/menu/pen.png"></md-button>

              <div class="plae basket item shoe" ng-repeat="shoe in shoeSelected" ng-model="shoeSelected">
                  <p><span class="name">{{shoe.name}}</span> -
                      <span class="color">{{shoe.color}} </span>
                      <span class="price">{{shoe.price | currency}}</span>
                      <md-button class="delete" id="delete-right" ng-click="plaeChef.removeTab('right')" ng-show="plaeChef.isEditMode()"><img src="img/menu/remove.png"></md-button>
                  </p>

              </div>

                  <div class="plae basket item left" ng-model="tabs" ng-model="tabLeft" ng-repeat="tabL in tabLeft track by $index">
                      <p><span class="name">{{tabL.name}}</span> -
                          <span class="color">{{tabL.color}}</span>
                          <span class="price">{{tabL.price | currency}}</span>
                      </p>
                      <md-button class="delete" id="delete-left" ng-click="plaeChef.removeTab('left')"ng-show="plaeChef.isEditMode()"><img src="img/menu/remove.png"></md-button>
                  </div>

                  <div class="plae basket item right" ng-model="tabs" ng-model="tabRight" ng-repeat="tabR in tabRight track by $index">
                      <p><span class="name">{{tabR.name}}</span> -
                          <span class="color">{{tabR.color}}</span>
                          <span class="price">{{tabR.price | currency}}</span>
                          <md-button class="delete" id="delete-right" ng-click="plaeChef.removeTab('right')" ng-show="plaeChef.isEditMode()"><img src="img/menu/remove.png"></md-button>

                      </p>
                      </div>


              <hr width="70%" size="1">
              <div class="plae basket subtotal" id="subtotal">
                  <p>subtotal <span class="price subtotal">{{plaeChef.getSubTotal() | currency}}</span></p>
              </div>


              <md-button class="view-button md-raised md-warn" id="reset-button" ng-click="plaeChef.clearSelections()" ng-show="plaeChef.isEditMode()" style="background: #ff0008;color: #fff;">
                  clear all selections
              </md-button>

          </div>
</div>


      <script src="app/bower_components/jquery/dist/jquery.min.js"></script>
      <script src="app/bower_components/jquery-ui/jquery-ui.min.js"></script>

      <script src="js/share.min.js"></script>
      <script src="js/waves.min.js"></script>
      <script src="app/bower_components/hammerjs/hammer.js"></script>
      <script src="bower_components/angular/angular.js"></script>
    <script src="app/bower_components/angular-animate/angular-animate.js"></script>
  <script src="components/angular-dragdrop/angular-dragdrop.min.js"></script>
      <script src="app/bower_components/angular-touch/angular-touch.js"></script>
      <script src="app/bower_components/angular-aria/angular-aria.js"></script>
      <script src="app/bower_components/angular-material/angular-material.js"></script>

<script src="js/plaeChefController.js"></script>



</body>
</html>
